<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script src="/socket.io/socket.io.js"></script>

<script>
  var server = io.connect('http://localhost');
  var name;
  server.on('connect', function(data){
    name = prompt("What's your name?");
    server.emit('join', name);
  })
  server.on('message', function (data) {
    var bot = data.from === "bot" ? ' class="bot"' : '';
        msg = '<div' + bot + '>' + data.from + ': ' + data.message + '</div>';

    $('#messages').append(msg);
  });


  $(function() {
      $('#chat').submit(function() {
        var message = $('#chatbox').val();
        $('#messages').append('<div>' + name + ': ' + message + '</div>');
        server.emit('message', message);
        $('#chatbox').val('');
        return false;
      });

      window.onbeforeunload = function(e){
        server.emit('leave');
      }

  });
</script>

<style type="text/css">
    #messages {
        height: 400px;
        width: 600px;
        border: 1px solid #ccc;
        overflow-y: scroll;
    }

    #chatbox {
        width: 602px;
        height: 30px;
        margin-top: 5px;
    }

    .bot {
        color: #ccc;
    }
</style>

<div id="messages">
</div>

<form id="chat">
    <input type="text" id="chatbox" />
    <input type="submit" />
</form>
